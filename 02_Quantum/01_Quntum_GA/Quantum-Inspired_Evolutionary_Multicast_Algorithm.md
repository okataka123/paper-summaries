# Quantum-Inspired Evolutionary Multicast Algorithm

## 要旨(Abstruct)
グローバルな最適化アルゴリズムとして、遺伝的アルゴリズム（GA）はマルチキャスト問題を解くためにますます適用されている。GAは従来のアルゴリズムよりも強力な探索能力を持つが、その「早熟性」の特性により、良好なマルチキャストツリーを得るのが困難である。本稿では、マルチキャストルーティング問題に対処するための量子インスパイア型進化アルゴリズム（QEA）を提示し、GAベースのマルチキャストアルゴリズムにおける「早熟性」問題を顕著に解決する。さらにQEAでは、集団内の個体が多状態遺伝子量子ビットによって表現されており、この表現は他のいかなる表現よりも集団における多様性生成の特性が優れている。個体の更新においては、量子回転ゲート戦略を用いて収束を加速する。このアルゴリズムは、実現が簡単で制御も柔軟であるという特性を持つ。シミュレーション結果は、QEAがCSおよび従来のGAよりも優れた性能を示すことを示している。

## I. 序論(Introduction)
ネットワークおよび通信技術の発展に伴い、マルチキャストルーティングサービスは、特定のサービス品質（QoS）を必要とするネットワークマルチメディアアプリケーションの主要な要件となりつつある。マルチキャストは、送信者から複数の受信者へ同一の情報をマルチキャストツリーに沿って送信することを含む。過去には、ネットワークリソースを効率的に管理できるよう、低コストのマルチキャストツリーを計算するアルゴリズムに多くの研究が注がれてきた。ネットワークにおける最小コストのマルチキャストツリー（すなわちシュタイナーツリー）を計算する問題はNP困難であるため【1】、提案されたアルゴリズムの大半はヒューリスティックなものである【2】–【4】。

いくつかの従来型ヒューリスティックアルゴリズムに加えて、進化的アルゴリズム【5】【6】はこの問題を解くために有望である。遺伝的アルゴリズムの成功にもかかわらず、それらは「早熟」および「停滞」といった同じ欠点を持つ。人工免疫アルゴリズムは理論免疫学に着想を得た新しい計算知能手法であり、QoSマルチキャストルーティング問題にも適用され、良好な性能を達成している【7】【8】。特に、従来の遺伝的アルゴリズム（CGA）および最良の制約付きヒューリスティックマルチキャストアルゴリズムである境界付き最短マルチキャストアルゴリズム（BSMA）【2】に対して、クローン戦略（CS）に基づくマルチキャストアルゴリズム【8】は、優れた多様性を維持し、局所最適に陥りにくいという利点を持つ。不幸にも、CSはクローン操作子により集団規模を増加させることで良好な局所探索能力を得ているが、集団の多様性と選択圧の特性は、免疫クローンアルゴリズムでは実装が容易ではない【9】。

最近【10】で提案された量子インスパイア型進化アルゴリズム（QEA）は、CGAと比較して、探索と活用のバランスをより容易に取ることができる。本稿では、QEAは少数の個体で探索空間を探索でき、短期間でグローバルな解を求めることができる。QEAは量子計算の概念と原理、すなわち量子ビットおよび状態の重ね合わせに基づいている。ネットワークの規模が増加するに従い、QEAはGAおよびCSよりも優れたマルチキャストツリーを見つけることができる。


## II. THE MULTICAST ROUTING PROBLEM DEFINITION
通信ネットワークはグラフ$V=(V,E)$によってモデル化され、ここで$V$はノードの集合、$E$はエッジの集合である。グラフ$G$上で関数$c(x, y)$および$d(x, y)$を定義する。ここで$c(x, y)$はエッジ$(x, y) \in E$を使用するコストであり、$d(x, y)$はエッジ$(x, y) \in E$に沿った遅延である。$P(a, b)$をノード$a$から$b$へのパスとするとき、遅延関数$Delay(a,b)$およびコスト関数$Cost(a, b)$は以下のように表される：
$$
\begin{align}
    \text{Delay}(a, b) &= \sum_{(x, y) \in P(a, b)} d(x, y) \\
    \text{Cost}(a, b) &= \sum_{(x, y) \in P(a, b)} c(x, y)
\end{align}
$$

送信元ノードを$s$とし、宛先ノードの集合を$D \subset V \backslash \{s\}$と仮定する。マルチキャストルーティング問題は、以下の制約を満たす木$T = (V_T, E_T)$を検索する問題である。$(T \subseteq G)$:

$$
    \text{Cost}(T) = \min \left( \sum_{(x, y) \in P_T(x, y)} c(x, y) \right) \\
    \sum_{(x, y) \in P_T(x, y)} d(x, y) \leq \Delta \quad \forall y \in D 
$$

ここで、$\Delta$は許容遅延であり、$P_T(x,y)$はマルチキャストツリー$T$における$x$から$y \in D$への一意なパスを表す。本論文では、ノード数$n = |V|$、宛先ノード数$m = |D|$とする。

## III. QEA
### A. Representation
本研究では、1個体は意思決定空間における探索点を表す。[9] において我々は、確率的表現としての量子ビットという新たな表現方法を提示しており、これは状態の線形重ね合わせを表現でき、他の表現よりも集団多様性において優れた特性を持つ【10】。以下に定義を示す。

> 定義1:
> 1量子ビットの確率振幅は、数の組$(\alpha, \beta)$によって以下のように定義される：
> 
> $$
> \begin{pmatrix} \alpha \\ \beta \end{pmatrix}
> $$

以下の制約を満たす：

$$
    |\alpha|^2 + |\beta|^2 = 1
$$

ここで、$|\alpha|^2$は、その量子ビットが「0」状態で観測される確率、$|\beta|^2$は「1」状態で観測される確率を表す。

> 定義2:
> $N$個の量子ビットからなる個体（qubit individual）は以下のように定義される：
> 
> $$
>     \begin{pmatrix}
>     \alpha_1 & \alpha_2 & \cdots & \alpha_N \\
>     \beta_1 & \beta_2 & \cdots & \beta_N
>     \end{pmatrix}
> $$

ここで、各$l = 1, 2, \cdots, N$において、$|\alpha_{l}|^2 + |\beta_{l}|^2 = 1$である。

#### B. Description of the Algorithm 
QEA は確率的なアルゴリズムであり、進化アルゴリズム（EA）に類似する。各世代$t$において、QEA は量子個体の集団$Q(t) = \{q_{1}^{t}, q_{2}^{t}, \cdots, q_{M}^{t}, \}$を維持する。ここで$M$は集団サイズ、$N$は量子個体$q_{i}^{t}$ の長さであり、これは以下のように定義される：

$$
q_i^t =
\begin{pmatrix}
\alpha_1^t & \alpha_2^t & \cdots & \alpha_N^t \\
\beta_1^t & \beta_2^t & \cdots & \beta_N^t
\end{pmatrix},
\quad i = 1, 2, \ldots, M
$$

QEAのメインループは次の通り：

アルゴリズム1：量子インスパイア型進化アルゴリズム

- $Q(t)$：$t$世代目の量子個体集団
- $P(t)$：$t$世代目の古典ビット個体集団
- b：現在の世代における最良の古典ビット個体

手順：
1. $Q(t)$と$b$を初期化し、$t=0$とする。
2. 更新された$Q(t)$を観測して$P(t)$を生成する。
3. $P(t)$の適応度を評価し、その中の最良解を$b$に格納する。
4. 量子突然変異によって$Q(t)$を更新する。
5. 終了条件を判定し、満たしていれば最良解を出力して終了。そうでなければ$t = t+1$
6. 手順2に戻る。

> [!Note]
> 交叉が無いんだが？

## IV. QUANTUM-INSPIRED EVOLUTIONARY MULTICAST ALGORITHM
#### A. 候補経路集合の構築

図1. 候補経路集合の探索フローチャート

グラフィックが$n$ノードを持つ完全グラフであると仮定する。つまり、ネットワーク内の各ノードは次数$n-1$を持つ。このネットワークにおいて、あるノードから指定ノードへの実現可能な経路の数は以下のように与えられる：

$$
    PathCount = 1 + P_{n-2}^{1} + P_{n-2}^{2} + P_{n-2}^{3} + \cdots + P_{n-2}^{n-2} > n! 
$$

> [!Note]
> Pの定義は？上式の計算方法が良く分からん。

このようなネットワークでマルチキャストツリーを構築する場合、考えられる組み合わせの数は次のように表される：

$$
    PathCount \times PathCount \times \cdots \times PathCount \quad (m回)
$$

ここで、$m$は宛先ノードの数である。
ネットワーク全体に制約がない場合、候補経路集合のサイズは非常に大きくなる。しかし遅延制約を加えることで、多くの候補経路が元の経路集合から除去される。すると、問題の規模は縮小される。遅延の制約が厳しいほど、候補経路集合は小さくなる。

各宛先ノード$d_i \in D (i = 1, 2, \cdots m)$に対して、まずは遅延制約$\Delta$以下を満たすすべてのパス$P_T(s, d_i)$を計算する。そして、候補経路集合はコスト昇順に並べられる。図1は候補経路集合の探索プロセスを示している。


#### B. エリート戦略に基づくエンコーダ
統計的観点から、シュタイナーツリーは候補経路集合内でコストが小さいパスで構成される。この事実は、貪欲戦略に基づく Prim や Kruskal のアルゴリズムでも観察される【1】。つまり、連続的に拡張されるスパニングツリーでは、常に最短の枝が選ばれる。したがって、シュタイナーツリーに含まれるパス$P(s, d_i) (i = 1, 2, \cdots, m)$のコストは小さいが、必ずしもすべてのパスの中で最小とは限らない。

ゆえに、収束速度を上げ、探索空間を狭めるためには、候補パスの数を減らすことが重要である。したがって、シュタイナーツリーは各宛先への最短経路の一部を含むと仮定できる。このため、我々はエリート戦略に基づき候補経路をエンコードする。すなわち、各宛先に対して最初の$2^{N}$本のパスを収集し、これら$2^{N} \times m$本のパスを「エリートグループ」とする（ここで$N$は1つの宛先ノードに対する候補パスを表現するために使う量子ビット数である）。よって、量子個体の長さは$D \times N$となり、以下のように定義される：

$$
    q^t =
    \begin{pmatrix}
    \alpha_{11}^t & \alpha_{12}^t & \cdots & \alpha_{1N}^t & \cdots & \alpha_{mN}^t \\
    \beta_{11}^t & \beta_{12}^t & \cdots & \beta_{1N}^t & \cdots & \beta_{mN}^t
    \end{pmatrix}
$$

ここで、すべての$i = 1, 2, \cdots, m$、$j = 1, 2, \cdots, N$に対して、

$$
    |\alpha_{ij}|^2 + |\beta_{ij}|^2 = 1
$$

である。

#### C. 観測演算子